# ***Im***age ***Sim***ilarity utilies

A CLI based on [this blogpost](https://medium.com/aimonks/image-similarity-with-dinov2-and-faiss-741744bc5804), built upon [FAISS](https://github.com/facebookresearch/faiss).

To create an index :
```python
imsim-cli vectorize create \
    --output-path PATH \
    --model-name TEXT \
    --root-dir PATH
```
this will create an FAISS vector index in `output-path`, with embeddings from `model-name` (HuggingFace model name) on images from `root-dir`.

To add a embeddings to the index :
```python
imsim-cli vectorize update \
    --input-path PATH \
    --output-path PATH \
    --model-name TEXT \
    --root-dir PATH
```
this will update the FAISS vector index in `input-path`, saving to `output-path`, with embeddings from `model-name` on images from `root-dir`.

Both `vectorize` subcommands generate a file with the name of the output suffixed with `-names.txt`, where each line `i` corresponds to the file name of the `i`-th file in the `root-dir`, sorted lexicographically.

To search for similar images:
```python
imsim-cli search images \
    --root-dir PATH \
    --model TEXT \
    --index PATH \
    [--top-n INTEGER] \
    [--tags PATH]
```
this will search for the `top-n` (defaults to 3) similar images in the FAISS index `index` based on embedding from `model-name` on images from `root-dir`. The `tags` option allows to pass in the path to the file containing file names generated by the `vectorize` subcommand.
